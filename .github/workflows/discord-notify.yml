name: GitHub â†’ Discord Embed

on:
  push:
    branches: [ "main" ]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Discord embed
        env:
          WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
          REPO: ${{ github.repository }}
          ACTOR: ${{ github.actor }}
          MESSAGE: ${{ github.event.head_commit.message }}
          URL: ${{ github.event.head_commit.url }}
        run: |
          payload=$(cat <<EOF
          {
            "username": "GitHub Bot",
            "avatar_url": "https://raw.githubusercontent.com/mzshortee5/lu-consumables/10b969bc6346438a2e5443873f5c89c96525aaf5/assets/github-bot.png",
            "embeds": [
              {
                "title": "ðŸš€ Repository Updated",
                "url": "$URL",
                "color": 15158332,
                "description": "**Repo:** $REPO\n**By:** $ACTOR\n\nðŸ“ $MESSAGE",
                "thumbnail": {
                  "url": "https://raw.githubusercontent.com/mzshortee5/lu-consumables/10b969bc6346438a2e5443873f5c89c96525aaf5/assets/github-bot.png"
                },
                "footer": {
                  "text": "Lu Scripts â€¢ GitHub Automation"
                },
                "timestamp": "$(date -u +%Y-%m-%dT%H:%M:%SZ)"
              }
            ]
          }
          EOF
          )

          curl -H "Content-Type: application/json" \
               -X POST \
               -d "$payload" \
               "$WEBHOOK"
